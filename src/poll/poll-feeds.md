// TODO: this module is huge, maybe my biggest, i don't like it, break it up
// somehow
